# SIP Server

Простой SIP сервер на Node.js для управления звонками между абонентами с короткими номерами от 100 до 110.

## Возможности

- Регистрация SIP абонентов с номерами 100-110
- Установка звонков между зарегистрированными абонентами
- Проксирование RTP трафика через сервер
- REST API для управления сервером
- Поддержка основных SIP методов (REGISTER, INVITE, BYE)

## Установка

```bash
npm install
```

## Запуск

```bash
node server.js
```

Сервер запустится на:
- SIP порт: 5060 (UDP)
- API порт: 3000 (HTTP)

## Конфигурация

Переменные окружения:
- `SIP_PORT` - порт для SIP (по умолчанию: 5060)
- `API_PORT` - порт для API (по умолчанию: 3000)

## API Endpoints

### Получить список зарегистрированных пользователей
```
GET /api/users
```

### Получить список валидных номеров
```
GET /api/extensions
```

### Получить активные звонки
```
GET /api/calls
```

### Удалить регистрацию пользователя
```
DELETE /api/users/:username
```

## Поддерживаемые номера

- 100
- 101
- 102
- 103
- 104
- 105
- 106
- 107
- 108
- 109
- 110

## SIP Сообщения

### REGISTER
Регистрация абонента на сервере.

### INVITE
Установка звонка между двумя абонентами.

### BYE
Завершение активного звонка.

## RTP Прокси

Сервер автоматически проксирует RTP трафик между абонентами, изменяя SDP сообщения для направления медиа-потоков через сервер.

## Логирование

Сервер выводит подробные логи в консоль:
- Регистрация/отмена регистрации абонентов
- Входящие звонки
- Установка и завершение звонков
- Ошибки и предупреждения

## Примеры использования

### Регистрация абонента 100
```
REGISTER sip:100@server.com SIP/2.0
Via: SIP/2.0/UDP client1:5060
From: <sip:100@server.com>
To: <sip:100@server.com>
Contact: <sip:100@client1:5060>
Call-ID: abc123
CSeq: 1 REGISTER
Expires: 3600
```

### Звонок от 100 к 101
```
INVITE sip:101@server.com SIP/2.0
Via: SIP/2.0/UDP client1:5060
From: <sip:100@server.com>
To: <sip:101@server.com>
Contact: <sip:100@client1:5060>
Call-ID: def456
CSeq: 1 INVITE
Content-Type: application/sdp
Content-Length: [длина SDP]

[SDP содержимое]
``` 